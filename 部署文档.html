<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>标书资质自动匹配系统 - 部署文档</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#165DFF',
                        secondary: '#36CFC9',
                        neutral: '#F5F7FA',
                        dark: '#1D2129',
                        light: '#FFFFFF',
                        success: '#52C41A',
                        warning: '#FAAD14',
                        danger: '#FF4D4F',
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .text-shadow {
                text-shadow: 0 2px 4px rgba(0,0,0,0.1);
            }
            .transition-all-300 {
                transition: all 300ms ease-in-out;
            }
        }
    </style>
</head>
<body class="bg-gray-50 font-sans text-gray-800">
    <!-- 顶部导航栏 -->
    <header class="sticky top-0 z-50 bg-white shadow-md transition-all duration-300" id="navbar">
        <div class="container mx-auto px-4 py-4 flex justify-between items-center">
            <div class="flex items-center space-x-2">
                <i class="fa fa-file-text-o text-primary text-2xl"></i>
                <h1 class="text-xl md:text-2xl font-bold text-primary">标书资质自动匹配系统</h1>
            </div>
            <nav class="hidden md:flex space-x-6">
                <a href="#system-requirements" class="hover:text-primary transition-all-300">系统要求</a>
                <a href="#environment-preparation" class="hover:text-primary transition-all-300">环境准备</a>
                <a href="#installation-steps" class="hover:text-primary transition-all-300">安装步骤</a>
                <a href="#configuration" class="hover:text-primary transition-all-300">配置说明</a>
                <a href="#faq" class="hover:text-primary transition-all-300">常见问题</a>
            </nav>
            <button class="md:hidden text-gray-700" id="menu-toggle">
                <i class="fa fa-bars text-xl"></i>
            </button>
        </div>
        <!-- 移动端菜单 -->
        <div class="md:hidden hidden bg-white border-t" id="mobile-menu">
            <div class="container mx-auto px-4 py-2 flex flex-col space-y-3">
                <a href="#system-requirements" class="py-2 hover:text-primary transition-all-300">系统要求</a>
                <a href="#environment-preparation" class="py-2 hover:text-primary transition-all-300">环境准备</a>
                <a href="#installation-steps" class="py-2 hover:text-primary transition-all-300">安装步骤</a>
                <a href="#configuration" class="py-2 hover:text-primary transition-all-300">配置说明</a>
                <a href="#faq" class="py-2 hover:text-primary transition-all-300">常见问题</a>
            </div>
        </div>
    </header>

    <!-- 主要内容 -->
    <main class="container mx-auto px-4 py-8">
        <!-- 文档标题区 -->
        <div class="mb-12 text-center">
            <h1 class="text-3xl md:text-4xl font-bold mb-4 text-dark">标书资质自动匹配系统 - 部署文档</h1>
            <p class="text-gray-600">版本: 1.0 | 最后更新: 2025-12-20</p>
            <div class="mt-6 inline-flex bg-white rounded-lg shadow p-4">
                <a href="#toc" class="flex items-center text-primary hover:underline">
                    <i class="fa fa-list-ul mr-2"></i> 查看目录
                </a>
            </div>
        </div>

        <!-- 目录 -->
        <div id="toc" class="bg-white rounded-lg shadow-lg p-6 mb-12">
            <h2 class="text-xl font-bold mb-4 flex items-center">
                <i class="fa fa-list-ul text-primary mr-2"></i>目录
            </h2>
            <ul class="space-y-2">
                <li><a href="#system-requirements" class="hover:text-primary transition-all-300">1. 系统要求</a></li>
                <li><a href="#environment-preparation" class="hover:text-primary transition-all-300">2. 环境准备</a></li>
                <li><a href="#installation-steps" class="hover:text-primary transition-all-300">3. 安装步骤</a></li>
                <li><a href="#configuration" class="hover:text-primary transition-all-300">4. 配置说明</a></li>
                <li><a href="#database-initialization" class="hover:text-primary transition-all-300">5. 数据库初始化</a></li>
                <li><a href="#start-system" class="hover:text-primary transition-all-300">6. 启动系统</a></li>
                <li><a href="#verify-deployment" class="hover:text-primary transition-all-300">7. 验证部署</a></li>
                <li><a href="#faq" class="hover:text-primary transition-all-300">8. 常见问题</a></li>
                <li><a href="#checklist" class="hover:text-primary transition-all-300">9. 部署检查清单</a></li>
                <li><a href="#maintenance" class="hover:text-primary transition-all-300">10. 后续维护</a></li>
            </ul>
        </div>

        <!-- 系统要求 -->
        <section id="system-requirements" class="mb-16 scroll-mt-20">
            <div class="bg-white rounded-lg shadow-lg p-6 md:p-8">
                <h2 class="text-2xl font-bold mb-6 flex items-center">
                    <i class="fa fa-server text-primary mr-3"></i>系统要求
                </h2>
                
                <div class="grid md:grid-cols-3 gap-6">
                    <!-- 硬件要求 -->
                    <div class="border border-gray-200 rounded-lg p-5 hover:shadow-md transition-all-300">
                        <h3 class="text-lg font-semibold mb-4 text-primary flex items-center">
                            <i class="fa fa-microchip mr-2"></i>硬件要求
                        </h3>
                        <ul class="space-y-2 text-gray-700">
                            <li><strong>CPU</strong>: 双核及以上（推荐四核）</li>
                            <li><strong>内存</strong>: 8GB 及以上（推荐 16GB）</li>
                            <li><strong>硬盘</strong>: 至少 20GB 可用空间</li>
                            <li><strong>网络</strong>: 稳定的互联网连接</li>
                        </ul>
                    </div>

                    <!-- 软件要求 -->
                    <div class="border border-gray-200 rounded-lg p-5 hover:shadow-md transition-all-300">
                        <h3 class="text-lg font-semibold mb-4 text-primary flex items-center">
                            <i class="fa fa-cogs mr-2"></i>软件要求
                        </h3>
                        <ul class="space-y-2 text-gray-700">
                            <li><strong>操作系统</strong>: Windows 10/11 或 Windows Server 2016+</li>
                            <li><strong>Python</strong>: 3.10 或 3.11（推荐 3.11）</li>
                            <li><strong>Microsoft Word</strong>: 已安装（用于解析 .doc 文件）</li>
                            <li><strong>浏览器</strong>: Chrome、Edge 或 Firefox（最新版本）</li>
                        </ul>
                    </div>

                    <!-- 第三方工具要求 -->
                    <div class="border border-gray-200 rounded-lg p-5 hover:shadow-md transition-all-300">
                        <h3 class="text-lg font-semibold mb-4 text-primary flex items-center">
                            <i class="fa fa-wrench mr-2"></i>第三方工具要求
                        </h3>
                        <ul class="space-y-2 text-gray-700">
                            <li><strong>Tesseract OCR</strong>: 用于PDF OCR识别</li>
                            <li><strong>Poppler</strong>: 用于PDF处理</li>
                            <li><strong>Ollama</strong>: 用于本地AI模型（可选）</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- 环境准备 -->
        <section id="environment-preparation" class="mb-16 scroll-mt-20">
            <div class="bg-white rounded-lg shadow-lg p-6 md:p-8">
                <h2 class="text-2xl font-bold mb-6 flex items-center">
                    <i class="fa fa-cubes text-primary mr-3"></i>环境准备
                </h2>

                <!-- 安装Python -->
                <div class="mb-8">
                    <h3 class="text-xl font-semibold mb-4 border-l-4 border-primary pl-3">1. 安装 Python</h3>
                    <ol class="list-decimal pl-6 space-y-3 mb-4">
                        <li>下载 Python 3.11：
                            <ul class="list-disc pl-6 mt-1">
                                <li>访问 <a href="https://www.python.org/downloads/" class="text-primary hover:underline" target="_blank">https://www.python.org/downloads/</a></li>
                                <li>下载 Windows 安装程序（64位）</li>
                                <li>运行安装程序，<strong class="text-danger">务必勾选 "Add Python to PATH"</strong></li>
                            </ul>
                        </li>
                        <li>验证安装：</li>
                    </ol>
                    <div class="bg-gray-900 text-gray-100 p-4 rounded-lg overflow-x-auto">
                        <pre><code>python --version
# 应显示：Python 3.11.x</code></pre>
                    </div>
                </div>

                <!-- 安装Microsoft Word -->
                <div class="mb-8">
                    <h3 class="text-xl font-semibold mb-4 border-l-4 border-primary pl-3">2. 安装 Microsoft Word</h3>
                    <ul class="list-disc pl-6 space-y-2">
                        <li>确保已安装 Microsoft Word（Office 2016 或更高版本）</li>
                        <li>Word COM组件用于解析 .doc 文件</li>
                    </ul>
                </div>

                <!-- 安装Tesseract OCR -->
                <div class="mb-8">
                    <h3 class="text-xl font-semibold mb-4 border-l-4 border-primary pl-3">3. 安装 Tesseract OCR</h3>
                    <ol class="list-decimal pl-6 space-y-3 mb-4">
                        <li>下载 Tesseract：
                            <ul class="list-disc pl-6 mt-1">
                                <li>访问 <a href="https://github.com/UB-Mannheim/tesseract/wiki" class="text-primary hover:underline" target="_blank">https://github.com/UB-Mannheim/tesseract/wiki</a></li>
                                <li>下载 Windows 安装程序</li>
                            </ul>
                        </li>
                        <li>安装：
                            <ul class="list-disc pl-6 mt-1">
                                <li>运行安装程序</li>
                                <li>安装路径建议：<code class="bg-gray-100 px-1 py-0.5 rounded">C:\Tesseract-OCR</code></li>
                                <li>安装时选择中文语言包（chi_sim）</li>
                            </ul>
                        </li>
                        <li>验证安装：</li>
                    </ol>
                    <div class="bg-gray-900 text-gray-100 p-4 rounded-lg overflow-x-auto">
                        <pre><code>tesseract --version</code></pre>
                    </div>
                </div>

                <!-- 安装Poppler -->
                <div class="mb-8">
                    <h3 class="text-xl font-semibold mb-4 border-l-4 border-primary pl-3">4. 安装 Poppler</h3>
                    <ol class="list-decimal pl-6 space-y-3">
                        <li>下载 Poppler：
                            <ul class="list-disc pl-6 mt-1">
                                <li>访问 <a href="https://github.com/oschwartz10612/poppler-windows/releases" class="text-primary hover:underline" target="_blank">https://github.com/oschwartz10612/poppler-windows/releases</a></li>
                                <li>下载最新版本（zip文件）</li>
                            </ul>
                        </li>
                        <li>解压：
                            <ul class="list-disc pl-6 mt-1">
                                <li>解压到项目目录或系统目录</li>
                                <li>例如：<code class="bg-gray-100 px-1 py-0.5 rounded">C:\Online\Online\Release-24.02.0-0\poppler-24.02.0\Library\bin</code></li>
                            </ul>
                        </li>
                    </ol>
                </div>

                <!-- 安装Ollama -->
                <div>
                    <h3 class="text-xl font-semibold mb-4 border-l-4 border-primary pl-3">5. 安装 Ollama（可选，用于本地AI模型）</h3>
                    <ol class="list-decimal pl-6 space-y-3 mb-4">
                        <li>下载 Ollama：
                            <ul class="list-disc pl-6 mt-1">
                                <li>访问 <a href="https://ollama.ai/download" class="text-primary hover:underline" target="_blank">https://ollama.ai/download</a></li>
                                <li>下载 Windows 安装程序</li>
                            </ul>
                        </li>
                        <li>安装并启动：</li>
                    </ol>
                    <div class="bg-gray-900 text-gray-100 p-4 rounded-lg overflow-x-auto mb-4">
                        <pre><code># 安装后，Ollama 会自动启动服务
# 验证服务是否运行
curl http://localhost:11434/api/tags</code></pre>
                    </div>
                    <p class="mb-2">3. 下载AI模型（可选）：</p>
                    <div class="bg-gray-900 text-gray-100 p-4 rounded-lg overflow-x-auto">
                        <pre><code>ollama pull llama3:8b
# 或使用云模型（推荐）</code></pre>
                    </div>
                </div>
            </div>
        </section>

        <!-- 安装步骤 -->
        <section id="installation-steps" class="mb-16 scroll-mt-20">
            <div class="bg-white rounded-lg shadow-lg p-6 md:p-8">
                <h2 class="text-2xl font-bold mb-6 flex items-center">
                    <i class="fa fa-download text-primary mr-3"></i>安装步骤
                </h2>

                <!-- 获取项目代码 -->
                <div class="mb-8">
                    <h3 class="text-xl font-semibold mb-4 border-l-4 border-primary pl-3">1. 获取项目代码</h3>
                    <div class="bg-gray-900 text-gray-100 p-4 rounded-lg overflow-x-auto">
                        <pre><code># 如果使用 Git
git clone &lt;repository_url&gt;
cd Online

# 或直接解压项目压缩包到目标目录
# 例如：C:\Online\Online</code></pre>
                    </div>
                </div>

                <!-- 创建虚拟环境 -->
                <div class="mb-8">
                    <h3 class="text-xl font-semibold mb-4 border-l-4 border-primary pl-3">2. 创建虚拟环境</h3>
                    <div class="bg-gray-900 text-gray-100 p-4 rounded-lg overflow-x-auto">
                        <pre><code># 进入项目目录
cd C:\Online\Online

# 创建虚拟环境
python -m venv .venv

# 激活虚拟环境
.venv\Scripts\activate

# 验证虚拟环境
python --version
# 应显示：Python 3.11.x</code></pre>
                    </div>
                </div>

                <!-- 安装Python依赖 -->
                <div class="mb-8">
                    <h3 class="text-xl font-semibold mb-4 border-l-4 border-primary pl-3">3. 安装 Python 依赖</h3>
                    <div class="bg-gray-900 text-gray-100 p-4 rounded-lg overflow-x-auto mb-4">
                        <pre><code># 确保虚拟环境已激活
pip install --upgrade pip

# 安装依赖包
pip install -r requirements.txt</code></pre>
                    </div>
                    <div class="bg-yellow-50 border-l-4 border-warning p-4">
                        <p class="font-medium">注意：</p>
                        <p>如果安装 <code class="bg-white px-1 py-0.5 rounded">pywin32</code> 失败，可以单独安装：</p>
                        <div class="bg-gray-900 text-gray-100 p-3 rounded-lg overflow-x-auto mt-2">
                            <pre><code>pip install pywin32
python Scripts/pywin32_postinstall.py -install</code></pre>
                        </div>
                    </div>
                </div>

                <!-- 配置系统路径 -->
                <div class="mb-8">
                    <h3 class="text-xl font-semibold mb-4 border-l-4 border-primary pl-3">4. 配置系统路径</h3>
                    <p class="mb-3">编辑 <code class="bg-gray-100 px-1 py-0.5 rounded">config.py</code> 文件，配置以下路径：</p>
                    <div class="bg-gray-900 text-gray-100 p-4 rounded-lg overflow-x-auto">
                        <pre><code># 解析配置
PARSE_CONFIG = {
    "tesseract_path": r"C:\Tesseract-OCR\Tesseract-OCR\tesseract.exe",  # 修改为实际路径
    'poppler_path': r'C:\Online\Online\Release-24.02.0-0\poppler-24.02.0\Library\bin'  # 修改为实际路径
}</code></pre>
                    </div>
                </div>

                <!-- 创建必要目录 -->
                <div>
                    <h3 class="text-xl font-semibold mb-4 border-l-4 border-primary pl-3">5. 创建必要目录</h3>
                    <p class="mb-3">系统会自动创建以下目录，但也可以手动创建：</p>
                    <div class="bg-gray-900 text-gray-100 p-4 rounded-lg overflow-x-auto">
                        <pre><code># 在项目根目录下创建
mkdir logs
mkdir tender_files
mkdir reports</code></pre>
                    </div>
                </div>
            </div>
        </section>

        <!-- 配置说明 -->
        <section id="configuration" class="mb-16 scroll-mt-20">
            <div class="bg-white rounded-lg shadow-lg p-6 md:p-8">
                <h2 class="text-2xl font-bold mb-6 flex items-center">
                    <i class="fa fa-sliders text-primary mr-3"></i>配置说明
                </h2>

                <div class="grid md:grid-cols-2 gap-8">
                    <!-- 爬虫配置 -->
                    <div>
                        <h3 class="text-xl font-semibold mb-4 border-l-4 border-primary pl-3">1. 爬虫配置（config.py）</h3>
                        <div class="bg-gray-900 text-gray-100 p-4 rounded-lg overflow-x-auto h-full">
                            <pre><code>SPIDER_CONFIG = {
    "daily_limit": 20,  # 每日爬取数量限制（根据需求调整）
    "zhejiang_max_pages": 35,  # 最大爬取页数
    "anti_crawl": {
        "request_interval": 2,  # 请求间隔（秒）
        "retry_times": 3,  # 重试次数
        "timeout": 15  # 超时时间（秒）
    }
}</code></pre>
                        </div>
                    </div>

                    <!-- AI配置 -->
                    <div>
                        <h3 class="text-xl font-semibold mb-4 border-l-4 border-primary pl-3">2. AI配置（config.py）</h3>
                        <div class="bg-gray-900 text-gray-100 p-4 rounded-lg overflow-x-auto h-full">
                            <pre><code>AI_CONFIG = {
    "provider": "ollama",
    "ollama": {
        "default_model": "cloud",  # 使用云模型或 "local" 使用本地模型
        "cloud_model": {
            "model_name": "qwen3-coder:480b-cloud",
            "base_url": "http://localhost:11434",
            "temperature": 0.05
        }
    }
}</code></pre>
                        </div>
                    </div>

                    <!-- 数据库配置 -->
                    <div>
                        <h3 class="text-xl font-semibold mb-4 border-l-4 border-primary pl-3">3. 数据库配置（config.py）</h3>
                        <p class="mb-3">系统默认使用 SQLite，无需额外配置：</p>
                        <div class="bg-gray-900 text-gray-100 p-4 rounded-lg overflow-x-auto h-full">
                            <pre><code>DB_CONFIG = {
    "db_type": "sqlite",
    "db_path": os.path.join(BASE_DIR, "tender_system.db")
}</code></pre>
                        </div>
                    </div>

                    <!-- 存储管理配置 -->
                    <div>
                        <h3 class="text-xl font-semibold mb-4 border-l-4 border-primary pl-3">4. 存储管理配置（config.py）</h3>
                        <div class="bg-gray-900 text-gray-100 p-4 rounded-lg overflow-x-auto h-full">
                            <pre><code>STORAGE_CONFIG = {
    "auto_cleanup_enabled": True,  # 启用自动清理
    "cleanup_interval_days": 30,  # 保留最近30天的文件
    "cleanup_schedule": "daily",  # 每天清理
    "cleanup_time": "02:00"  # 凌晨2点清理
}</code></pre>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 数据库初始化 -->
        <section id="database-initialization" class="mb-16 scroll-mt-20">
            <div class="bg-white rounded-lg shadow-lg p-6 md:p-8">
                <h2 class="text-2xl font-bold mb-6 flex items-center">
                    <i class="fa fa-database text-primary mr-3"></i>数据库初始化
                </h2>
                <p class="mb-4">系统首次启动时会自动初始化数据库：</p>
                
                <div class="space-y-6">
                    <div>
                        <h3 class="text-lg font-semibold mb-2">1. 自动初始化：</h3>
                        <ul class="list-disc pl-6 space-y-1">
                            <li>运行 <code class="bg-gray-100 px-1 py-0.5 rounded">app.py</code> 时，系统会自动调用 <code class="bg-gray-100 px-1 py-0.5 rounded">init_db()</code></li>
                            <li>创建所有必要的数据库表</li>
                            <li>插入默认的A类证书和B类规则数据</li>
                        </ul>
                    </div>

                    <div>
                        <h3 class="text-lg font-semibold mb-2">2. 手动初始化（如需要）：</h3>
                        <div class="bg-gray-900 text-gray-100 p-4 rounded-lg overflow-x-auto">
                            <pre><code>from utils.db import init_db
init_db()</code></pre>
                        </div>
                    </div>

                    <div>
                        <h3 class="text-lg font-semibold mb-2">3. 数据库文件位置：</h3>
                        <ul class="list-disc pl-6 space-y-1">
                            <li>SQLite 数据库文件：<code class="bg-gray-100 px-1 py-0.5 rounded">tender_system.db</code></li>
                            <li>位于项目根目录</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- 启动系统 -->
        <section id="start-system" class="mb-16 scroll-mt-20">
            <div class="bg-white rounded-lg shadow-lg p-6 md:p-8">
                <h2 class="text-2xl font-bold mb-6 flex items-center">
                    <i class="fa fa-play-circle text-primary mr-3"></i>启动系统
                </h2>

                <div class="grid md:grid-cols-2 gap-8">
                    <!-- 方式一：Streamlit Web界面 -->
                    <div class="border border-gray-200 rounded-lg p-5 hover:shadow-md transition-all-300">
                        <h3 class="text-xl font-semibold mb-4 text-primary">方式一：使用 Streamlit Web界面（推荐）</h3>
                        <div class="bg-gray-900 text-gray-100 p-4 rounded-lg overflow-x-auto mb-4">
                            <pre><code># 确保虚拟环境已激活
.venv\Scripts\activate

# 启动应用
streamlit run app.py

# 或使用完整路径
.venv\Scripts\python.exe -m streamlit run app.py</code></pre>
                        </div>
                        <p>启动后，浏览器会自动打开，或手动访问：<code class="bg-gray-100 px-1 py-0.5 rounded">http://localhost:8501</code></p>
                    </div>

                    <!-- 方式二：命令行全流程 -->
                    <div class="border border-gray-200 rounded-lg p-5 hover:shadow-md transition-all-300">
                        <h3 class="text-xl font-semibold mb-4 text-primary">方式二：使用命令行全流程</h3>
                        <div class="bg-gray-900 text-gray-100 p-4 rounded-lg overflow-x-auto mb-4">
                            <pre><code># 激活虚拟环境
.venv\Scripts\activate

# 运行全流程
python auto_run_full_process.py --daily_limit 20 --model_type cloud</code></pre>
                        </div>
                        <p class="mb-2">参数说明：</p>
                        <ul class="list-disc pl-6">
                            <li><code class="bg-gray-100 px-1 py-0.5 rounded">--daily_limit</code>: 爬取数量限制</li>
                            <li><code class="bg-gray-100 px-1 py-0.5 rounded">--model_type</code>: AI模型类型（local 或 cloud）</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- 验证部署 -->
        <section id="verify-deployment" class="mb-16 scroll-mt-20">
            <div class="bg-white rounded-lg shadow-lg p-6 md:p-8">
                <h2 class="text-2xl font-bold mb-6 flex items-center">
                    <i class="fa fa-check-square-o text-primary mr-3"></i>验证部署
                </h2>

                <div class="space-y-8">
                    <!-- 运行配置检查工具 -->
                    <div>
                        <h3 class="text-xl font-semibold mb-4 border-l-4 border-primary pl-3">1. 运行配置检查工具</h3>
                        <div class="bg-gray-900 text-gray-100 p-4 rounded-lg overflow-x-auto mb-4">
                            <pre><code># 激活虚拟环境
.venv\Scripts\activate

# 运行配置检查
python check_server_config.py</code></pre>
                        </div>
                        <p class="mb-2">检查项包括：</p>
                        <ul class="list-disc pl-6 space-y-1">
                            <li><i class="fa fa-check text-success"></i> Ollama服务连接</li>
                            <li><i class="fa fa-check text-success"></i> 文件路径配置（Tesseract、Poppler）</li>
                            <li><i class="fa fa-check text-success"></i> Python环境和依赖包</li>
                            <li><i class="fa fa-check text-success"></i> Word COM组件</li>
                        </ul>
                    </div>

                    <!-- 测试文件解析 -->
                    <div>
                        <h3 class="text-xl font-semibold mb-4 border-l-4 border-primary pl-3">2. 测试文件解析</h3>
                        <div class="bg-gray-900 text-gray-100 p-4 rounded-lg overflow-x-auto">
                            <pre><code># 运行文件解析测试
python test_file_parser.py</code></pre>
                        </div>
                    </div>

                    <!-- 测试Web界面 -->
                    <div>
                        <h3 class="text-xl font-semibold mb-4 border-l-4 border-primary pl-3">3. 测试Web界面</h3>
                        <ol class="list-decimal pl-6 space-y-2">
                            <li>启动 Streamlit 应用</li>
                            <li>访问各个页面，检查功能是否正常：
                                <ul class="list-disc pl-6 mt-1">
                                    <li>项目概览</li>
                                    <li>流程执行</li>
                                    <li>资质管理</li>
                                    <li>报告生成</li>
                                </ul>
                            </li>
                        </ol>
                    </div>

                    <!-- 测试完整流程 -->
                    <div>
                        <h3 class="text-xl font-semibold mb-4 border-l-4 border-primary pl-3">4. 测试完整流程</h3>
                        <ol class="list-decimal pl-6 space-y-2">
                            <li>在Web界面选择"全流程"</li>
                            <li>设置爬取数量为 1-2 个（测试用）</li>
                            <li>执行全流程，验证：
                                <ul class="list-disc pl-6 mt-1">
                                    <li>爬虫是否正常工作</li>
                                    <li>文件解析是否成功</li>
                                    <li>AI分析是否正常</li>
                                    <li>报告是否生成</li>
                                </ul>
                            </li>
                        </ol>
                    </div>
                </div>
            </div>
        </section>

        <!-- 常见问题 -->
        <section id="faq" class="mb-16 scroll-mt-20">
            <div class="bg-white rounded-lg shadow-lg p-6 md:p-8">
                <h2 class="text-2xl font-bold mb-6 flex items-center">
                    <i class="fa fa-question-circle text-primary mr-3"></i>常见问题
                </h2>

                <div class="space-y-6">
                    <!-- 问题1：Python模块导入错误 -->
                    <div class="border border-gray-200 rounded-lg overflow-hidden">
                        <div class="bg-gray-50 p-4 font-medium flex items-center">
                            <i class="fa fa-exclamation-triangle text-warning mr-2"></i>
                            1. Python 模块导入错误
                        </div>
                        <div class="p-4">
                            <p class="mb-3"><strong>问题</strong>：<code class="bg-gray-100 px-1 py-0.5 rounded">ModuleNotFoundError: No module named 'xxx'</code></p>
                            <p class="mb-2"><strong>解决</strong>：</p>
                            <div class="bg-gray-900 text-gray-100 p-4 rounded-lg overflow-x-auto">
                                <pre><code># 确保虚拟环境已激活
.venv\Scripts\activate

# 重新安装依赖
pip install -r requirements.txt</code></pre>
                            </div>
                        </div>
                    </div>

                    <!-- 问题2：Word COM组件不可用 -->
                    <div class="border border-gray-200 rounded-lg overflow-hidden">
                        <div class="bg-gray-50 p-4 font-medium flex items-center">
                            <i class="fa fa-exclamation-triangle text-warning mr-2"></i>
                            2. Word COM 组件不可用
                        </div>
                        <div class="p-4">
                            <p class="mb-3"><strong>问题</strong>：无法解析 .doc 文件</p>
                            <p class="mb-2"><strong>解决</strong>：</p>
                            <ul class="list-disc pl-6 space-y-1">
                                <li>确保已安装 Microsoft Word</li>
                                <li>检查 Word 是否正常运行</li>
                                <li>运行 <code class="bg-gray-100 px-1 py-0.5 rounded">python test_file_parser.py</code> 诊断问题</li>
                            </ul>
                        </div>
                    </div>

                    <!-- 问题3：Tesseract路径错误 -->
                    <div class="border border-gray-200 rounded-lg overflow-hidden">
                        <div class="bg-gray-50 p-4 font-medium flex items-center">
                            <i class="fa fa-exclamation-triangle text-warning mr-2"></i>
                            3. Tesseract 路径错误
                        </div>
                        <div class="p-4">
                            <p class="mb-3"><strong>问题</strong>：<code class="bg-gray-100 px-1 py-0.5 rounded">FileNotFoundError: [WinError 2] 系统找不到指定的文件</code></p>
                            <p class="mb-2"><strong>解决</strong>：</p>
                            <ul class="list-disc pl-6 space-y-1">
                                <li>检查 <code class="bg-gray-100 px-1 py-0.5 rounded">config.py</code> 中的 <code class="bg-gray-100 px-1 py-0.5 rounded">tesseract_path</code> 配置</li>
                                <li>确保路径正确且 Tesseract 已安装</li>
                                <li>使用绝对路径</li>
                            </ul>
                        </div>
                    </div>

                    <!-- 问题4：Poppler路径错误 -->
                    <div class="border border-gray-200 rounded-lg overflow-hidden">
                        <div class="bg-gray-50 p-4 font-medium flex items-center">
                            <i class="fa fa-exclamation-triangle text-warning mr-2"></i>
                            4. Poppler 路径错误
                        </div>
                        <div class="p-4">
                            <p class="mb-3"><strong>问题</strong>：PDF 处理失败</p>
                            <p class="mb-2"><strong>解决</strong>：</p>
                            <ul class="list-disc pl-6 space-y-1">
                                <li>检查 <code class="bg-gray-100 px-1 py-0.5 rounded">config.py</code> 中的 <code class="bg-gray-100 px-1 py-0.5 rounded">poppler_path</code> 配置</li>
                                <li>确保路径指向 <code class="bg-gray-100 px-1 py-0.5 rounded">bin</code> 目录</li>
                                <li>使用绝对路径</li>
                            </ul>
                        </div>
                    </div>

                    <!-- 问题5：Ollama连接失败 -->
                    <div class="border border-gray-200 rounded-lg overflow-hidden">
                        <div class="bg-gray-50 p-4 font-medium flex items-center">
                            <i class="fa fa-exclamation-triangle text-warning mr-2"></i>
                            5. Ollama 连接失败
                        </div>
                        <div class="p-4">
                            <p class="mb-3"><strong>问题</strong>：AI 分析无法进行</p>
                            <p class="mb-2"><strong>解决</strong>：</p>
                            <ul class="list-disc pl-6 space-y-1">
                                <li>检查 Ollama 服务是否运行：<code class="bg-gray-100 px-1 py-0.5 rounded">curl http://localhost:11434/api/tags</code></li>
                                <li>检查 <code class="bg-gray-100 px-1 py-0.5 rounded">config.py</code> 中的 <code class="bg-gray-100 px-1 py-0.5 rounded">base_url</code> 配置</li>
                                <li>如果使用云模型，确保模型名称正确</li>
                            </ul>
                        </div>
                    </div>

                    <!-- 问题6-8 省略部分代码，保持结构一致 -->
                    <!-- 问题6：数据库初始化失败 -->
                    <div class="border border-gray-200 rounded-lg overflow-hidden">
                        <div class="bg-gray-50 p-4 font-medium flex items-center">
                            <i class="fa fa-exclamation-triangle text-warning mr-2"></i>
                            6. 数据库初始化失败
                        </div>
                        <div class="p-4">
                            <p class="mb-3"><strong>问题</strong>：数据库表创建失败</p>
                            <p class="mb-2"><strong>解决</strong>：</p>
                            <ul class="list-disc pl-6 space-y-1">
                                <li>检查项目目录是否有写入权限</li>
                                <li>删除旧的 <code class="bg-gray-100 px-1 py-0.5 rounded">tender_system.db</code> 文件，重新初始化</li>
                                <li>检查 SQLite 是否正常工作</li>
                            </ul>
                        </div>
                    </div>

                    <!-- 问题7：端口被占用 -->
                    <div class="border border-gray-200 rounded-lg overflow-hidden">
                        <div class="bg-gray-50 p-4 font-medium flex items-center">
                            <i class="fa fa-exclamation-triangle text-warning mr-2"></i>
                            7. 端口被占用
                        </div>
                        <div class="p-4">
                            <p class="mb-3"><strong>问题</strong>：Streamlit 无法启动</p>
                            <p class="mb-2"><strong>解决</strong>：</p>
                            <div class="bg-gray-900 text-gray-100 p-4 rounded-lg overflow-x-auto">
                                <pre><code># 使用其他端口启动
streamlit run app.py --server.port 8502</code></pre>
                            </div>
                        </div>
                    </div>

                    <!-- 问题8：虚拟环境激活失败 -->
                    <div class="border border-gray-200 rounded-lg overflow-hidden">
                        <div class="bg-gray-50 p-4 font-medium flex items-center">
                            <i class="fa fa-exclamation-triangle text-warning mr-2"></i>
                            8. 虚拟环境激活失败
                        </div>
                        <div class="p-4">
                            <p class="mb-3"><strong>问题</strong>：<code class="bg-gray-100 px-1 py-0.5 rounded">无法加载文件，因为在此系统上禁止运行脚本</code></p>
                            <p class="mb-2"><strong>解决</strong>：</p>
                            <div class="bg-gray-900 text-gray-100 p-4 rounded-lg overflow-x-auto">
                                <pre><code># 以管理员身份运行 PowerShell
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser</code></pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 部署检查清单 -->
        <section id="checklist" class="mb-16 scroll-mt-20">
            <div class="bg-white rounded-lg shadow-lg p-6 md:p-8">
                <h2 class="text-2xl font-bold mb-6 flex items-center">
                    <i class="fa fa-list-alt text-primary mr-3"></i>部署检查清单
                </h2>
                <p class="mb-4">部署完成后，请确认以下项目：</p>
                
                <div class="grid md:grid-cols-2 gap-x-8 gap-y-2">
                    <div class="flex items-center">
                        <input type="checkbox" id="check1" class="w-5 h-5 mr-2">
                        <label for="check1">Python 3.11 已安装并添加到 PATH</label>
                    </div>
                    <div class="flex items-center">
                        <input type="checkbox" id="check2" class="w-5 h-5 mr-2">
                        <label for="check2">虚拟环境已创建并激活</label>
                    </div>
                    <div class="flex items-center">
                        <input type="checkbox" id="check3" class="w-5 h-5 mr-2">
                        <label for="check3">所有依赖包已安装（<code class="bg-gray-100 px-1 py-0.5 rounded">pip list</code> 检查）</label>
                    </div>
                    <div class="flex items-center">
                        <input type="checkbox" id="check4" class="w-5 h-5 mr-2">
                        <label for="check4">Microsoft Word 已安装</label>
                    </div>
                    <div class="flex items-center">
                        <input type="checkbox" id="check5" class="w-5 h-5 mr-2">
                        <label for="check5">Tesseract OCR 已安装并配置路径</label>
                    </div>
                    <div class="flex items-center">
                        <input type="checkbox" id="check6" class="w-5 h-5 mr-2">
                        <label for="check6">Poppler 已解压并配置路径</label>
                    </div>
                    <div class="flex items-center">
                        <input type="checkbox" id="check7" class="w-5 h-5 mr-2">
                        <label for="check7">Ollama 已安装（如使用本地模型）</label>
                    </div>
                    <div class="flex items-center">
                        <input type="checkbox" id="check8" class="w-5 h-5 mr-2">
                        <label for="check8"><code class="bg-gray-100 px-1 py-0.5 rounded">config.py</code> 中的路径配置正确</label>
                    </div>
                    <div class="flex items-center">
                        <input type="checkbox" id="check9" class="w-5 h-5 mr-2">
                        <label for="check9">数据库初始化成功</label>
                    </div>
                    <div class="flex items-center">
                        <input type="checkbox" id="check10" class="w-5 h-5 mr-2">
                        <label for="check10">配置检查工具运行通过</label>
                    </div>
                    <div class="flex items-center">
                        <input type="checkbox" id="check11" class="w-5 h-5 mr-2">
                        <label for="check11">Web 界面可以正常访问</label>
                    </div>
                    <div class="flex items-center">
                        <input type="checkbox" id="check12" class="w-5 h-5 mr-2">
                        <label for="check12">测试流程执行成功</label>
                    </div>
                </div>
            </div>
        </section>

        <!-- 后续维护 -->
        <section id="maintenance" class="mb-16 scroll-mt-20">
            <div class="bg-white rounded-lg shadow-lg p-6 md:p-8">
                <h2 class="text-2xl font-bold mb-6 flex items-center">
                    <i class="fa fa-wrench text-primary mr-3"></i>后续维护
                </h2>

                <div class="grid md:grid-cols-2 gap-8">
                    <!-- 定期任务 -->
                    <div>
                        <h3 class="text-xl font-semibold mb-4 border-l-4 border-primary pl-3">定期任务</h3>
                        <div class="space-y-4">
                            <div>
                                <h4 class="font-medium flex items-center">
                                    <i class="fa fa-trash-o text-gray-500 mr-2"></i>日志清理
                                </h4>
                                <ul class="list-disc pl-6 mt-1 text-gray-700 text-sm">
                                    <li>日志文件位于 <code class="bg-gray-100 px-1 py-0.5 rounded">logs/</code> 目录</li>
                                    <li>定期清理旧日志文件</li>
                                </ul>
                            </div>

                            <div>
                                <h4 class="font-medium flex items-center">
                                    <i class="fa fa-file-o text-gray-500 mr-2"></i>文件清理
                                </h4>
                                <ul class="list-disc pl-6 mt-1 text-gray-700 text-sm">
                                    <li>系统会自动清理旧文件（根据 <code class="bg-gray-100 px-1 py-0.5 rounded">STORAGE_CONFIG</code> 配置）</li>
                                    <li>也可手动运行清理工具</li>
                                </ul>
                            </div>

                            <div>
                                <h4 class="font-medium flex items-center">
                                    <i class="fa fa-database text-gray-500 mr-2"></i>数据库备份
                                </h4>
                                <ul class="list-disc pl-6 mt-1 text-gray-700 text-sm">
                                    <li>定期备份 <code class="bg-gray-100 px-1 py-0.5 rounded">tender_system.db</code> 文件</li>
                                    <li>建议每周备份一次</li>
                                </ul>
                            </div>

                            <div>
                                <h4 class="font-medium flex items-center">
                                    <i class="fa fa-refresh text-gray-500 mr-2"></i>依赖更新
                                </h4>
                                <div class="bg-gray-900 text-gray-100 p-3 rounded-lg overflow-x-auto mt-1 text-sm">
                                    <pre><code># 更新依赖包
pip install --upgrade -r requirements.txt</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 性能优化 -->
                    <div>
                        <h3 class="text-xl font-semibold mb-4 border-l-4 border-primary pl-3">性能优化</h3>
                        <ul class="space-y-3 text-gray-700">
                            <li class="flex">
                                <i class="fa fa-rocket text-primary mt-1 mr-3"></i>
                                <div>
                                    <strong>调整爬取数量</strong>：根据服务器性能调整 <code class="bg-gray-100 px-1 py-0.5 rounded">daily_limit</code>
                                </div>
                            </li>
                            <li class="flex">
                                <i class="fa fa-brain text-primary mt-1 mr-3"></i>
                                <div>
                                    <strong>调整AI模型</strong>：根据需求选择本地或云模型
                                </div>
                            </li>
                            <li class="flex">
                                <i class="fa fa-hdd-o text-primary mt-1 mr-3"></i>
                                <div>
                                    <strong>磁盘空间监控</strong>：定期检查磁盘使用情况
                                </div>
                            </li>
                        </ul>

                        <h3 class="text-xl font-semibold mt-8 mb-4 border-l-4 border-primary pl-3">技术支持</h3>
                        <p class="mb-2">如遇到问题，请：</p>
                        <ol class="list-decimal pl-6 space-y-1 text-gray-700">
                            <li>查看日志文件：<code class="bg-gray-100 px-1 py-0.5 rounded">logs/tender_system.log</code></li>
                            <li>运行诊断工具：<code class="bg-gray-100 px-1 py-0.5 rounded">check_server_config.py</code></li>
                            <li>检查配置文件：<code class="bg-gray-100 px-1 py-0.5 rounded">config.py</code></li>
                            <li>查看错误信息并搜索解决方案</li>
                        </ol>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- 页脚 -->
    <footer class="bg-gray-800 text-white py-8">
        <div class="container mx-auto px-4">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="mb-4 md:mb-0">
                    <div class="flex items-center">
                        <i class="fa fa-file-text-o text-primary text-2xl mr-2"></i>
                        <h2 class="text-xl font-bold">标书资质自动匹配系统</h2>
                    </div>
                    <p class="text-gray-400 mt-2">部署文档 v1.0 | 最后更新: 2025-12-20</p>
                </div>
                <div class="flex space-x-4">
                    <a href="#" class="text-gray-400 hover:text-white transition-all-300">
                        <i class="fa fa-question-circle text-xl"></i>
                    </a>
                    <a href="#" class="text-gray-400 hover:text-white transition-all-300">
                        <i class="fa fa-envelope text-xl"></i>
                    </a>
                    <a href="#" class="text-gray-400 hover:text-white transition-all-300">
                        <i class="fa fa-github text-xl"></i>
                    </a>
                </div>
            </div>
            <div class="border-t border-gray-700 mt-6 pt-6 text-center text-gray-400 text-sm">
                &copy; 2025 标书资质自动匹配系统 版权所有
            </div>
        </div>
    </footer>

    <!-- 返回顶部按钮 -->
    <button id="back-to-top" class="fixed bottom-6 right-6 bg-primary text-white w-12 h-12 rounded-full shadow-lg flex items-center justify-center opacity-0 invisible transition-all duration-300">
        <i class="fa fa-arrow-up"></i>
    </button>

    <!-- JavaScript -->
    <script>
        // 移动端菜单切换
        document.getElementById('menu-toggle').addEventListener('click', function() {
            const mobileMenu = document.getElementById('mobile-menu');
            mobileMenu.classList.toggle('hidden');
        });

        // 导航栏滚动效果
        window.addEventListener('scroll', function() {
            const navbar = document.getElementById('navbar');
            const backToTop = document.getElementById('back-to-top');
            
            if (window.scrollY > 100) {
                navbar.classList.add('py-2');
                navbar.classList.remove('py-4');
                backToTop.classList.remove('opacity-0', 'invisible');
                backToTop.classList.add('opacity-100', 'visible');
            } else {
                navbar.classList.add('py-4');
                navbar.classList.remove('py-2');
                backToTop.classList.add('opacity-0', 'invisible');
                backToTop.classList.remove('opacity-100', 'visible');
            }
        });

        // 返回顶部功能
        document.getElementById('back-to-top').addEventListener('click', function() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });

        // 平滑滚动
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                
                // 关闭移动菜单（如果打开）
                document.getElementById('mobile-menu').classList.add('hidden');
                
                document.querySelector(this.getAttribute('href')).scrollIntoView({
                    behavior: 'smooth'
                });
            });
        });

        // 代码块复制功能
        const codeBlocks = document.querySelectorAll('pre code');
        codeBlocks.forEach(block => {
            const pre = block.parentElement;
            const copyBtn = document.createElement('button');
            copyBtn.className = 'absolute top-2 right-2 bg-gray-700 text-white px-2 py-1 rounded text-xs opacity-0 hover:opacity-100 transition-opacity';
            copyBtn.textContent = '复制';
            copyBtn.addEventListener('click', () => {
                navigator.clipboard.writeText(block.textContent).then(() => {
                    copyBtn.textContent = '已复制';
                    setTimeout(() => {
                        copyBtn.textContent = '复制';
                    }, 2000);
                });
            });
            
            pre.style.position = 'relative';
            pre.appendChild(copyBtn);
            
            pre.addEventListener('mouseenter', () => {
                copyBtn.style.opacity = '1';
            });
            
            pre.addEventListener('mouseleave', () => {
                copyBtn.style.opacity = '0';
            });
        });
    </script>
</body>
</html>